<!DOCTYPE html>
<html lang="zn-Hans">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, maximum-scale=1" />
  <meta name="author" content="半生不熟 | Amber">
  <meta name="description" content="问题 今天帮朋友看了一个问题，是要实现点击按钮出现一个弹框以及背景遮罩的功能。 因为项目在用Bootstrap，所以第一想法当然是直接用Bootstrap的模态框，但是奇葩的是一直出现闪退的情况，但之前从来没有遇到这种情况，就去搜了下。 看到大部分人都说一般是因为JS文件发生了冲突，想了想可能项目引入的库有重写模态框的东西，但是试了半天也没有找到是哪个文件，于是决定换一种方式了，因为项目原因，要尽量少用">
  
  <meta property="og:title" content="模态框和禁止页面滚动" />
<meta property="og:description" content="问题 今天帮朋友看了一个问题，是要实现点击按钮出现一个弹框以及背景遮罩的功能。 因为项目在用Bootstrap，所以第一想法当然是直接用Bootstrap的模态框，但是奇葩的是一直出现闪退的情况，但之前从来没有遇到这种情况，就去搜了下。 看到大部分人都说一般是因为JS文件发生了冲突，想了想可能项目引入的库有重写模态框的东西，但是试了半天也没有找到是哪个文件，于是决定换一种方式了，因为项目原因，要尽量少用" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://wdanna.com/posts/blog/%E6%A8%A1%E6%80%81%E6%A1%86%E5%92%8C%E7%A6%81%E6%AD%A2%E9%A1%B5%E9%9D%A2%E6%BB%9A%E5%8A%A8/" />
<meta property="og:see_also" content="https://wdanna.com/posts/blog/2017-12/flex%E5%B8%83%E5%B1%80%E4%B9%9F%E5%B0%B1%E8%BF%99%E4%B9%88%E5%A4%9A/" /><meta property="og:see_also" content="https://wdanna.com/posts/blog/2017-09/react%E9%82%A3%E4%BA%9B%E4%BA%8B/" /><meta property="og:see_also" content="https://wdanna.com/posts/blog/2017-08/css-%E5%AE%9E%E7%8E%B0%E5%8A%A8%E6%80%81%E7%99%BE%E5%88%86%E6%AF%94%E5%9C%86%E7%8E%AF/" /><meta property="og:see_also" content="https://wdanna.com/posts/books/2017-05/%E8%AE%A9%E5%A4%A7%E8%84%91%E6%AD%87%E6%AD%87%E5%90%A7-%E7%8E%A9%E7%8E%A9gtd/" /><meta property="og:see_also" content="https://wdanna.com/posts/books/2017-05/%E8%AF%95%E4%BA%86%E5%85%AD%E5%A4%A9gtd%E7%9A%84%E6%88%91/" /><meta property="og:see_also" content="https://wdanna.com/posts/blog/2016-12/trello-%E6%97%A0%E6%B3%95%E6%89%93%E5%BC%80/" />



  <title>
  
       模态框和禁止页面滚动 | 半生不熟 | Amber 
  
  </title>

  <link rel="canonical" href="https://wdanna.com/posts/blog/%E6%A8%A1%E6%80%81%E6%A1%86%E5%92%8C%E7%A6%81%E6%AD%A2%E9%A1%B5%E9%9D%A2%E6%BB%9A%E5%8A%A8/">

  
  

  
  <link href="https://wdanna.com/css/vendors-extensions/fontawesome/all.min.css" rel="stylesheet">

  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,700|Ubuntu+Mono:400,400i,700,700i|Raleway:300,400,500,600">
  <link href="https://wdanna.com/css/font.css" rel="stylesheet"> 
    
  
  <link href="https://wdanna.com/css/vendors/bootstrap4/bootstrap.min.css" rel="stylesheet">
  <link href="https://wdanna.com/css/vendors-extensions/mdb/mdb.min.css" rel="stylesheet"> 
  <link href="https://wdanna.com/css/vendors/mdb/style.min.css" rel="stylesheet"> 
  <link href="https://wdanna.com/css/main.css" rel="stylesheet">


  
  <link rel="shortcut icon"
      href="https://image.wdanna.com/avatar/favicon.ico"
      href="https://image.wdanna.com/avatar/my_profile.jpg"
  >


  
  

  <style type="text/css">
      @media (min-width: 800px) and (max-width: 850px) {
              .navbar:not(.top-nav-collapse) {
                  background: #1C2331!important;
              }
          }
  </style>


  
    
    <link rel="stylesheet" href="https://wdanna.com/js/vendors/katex/katex.min.css">
  
  

  
    
    <link rel="stylesheet" href="https://wdanna.com/css/vendors/highlight/github-gist.css">
  

</head>

  <body class="bg-light" data-spy="scroll" data-target="#page-scrollspy" data-offset="90">
  
    
    

    
      


<nav class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar">
    <div class="container">

      
      <a class="navbar-brand" href="https://wdanna.com/">
        <img class="avatar" src="https://image.wdanna.com/avatar/favicon.ico" style="width: 40px!important;height: auto;"  class="d-inline-block align-top" alt="" >
        <strong> 半生不熟 | Amber</strong>
      </a>

      
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
        aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      
      <div class="collapse navbar-collapse" id="navbarSupportedContent">

        
        <ul class="navbar-nav mr-auto ">
          <li class="nav-item ">
            <a class="nav-link" href="https://wdanna.com/">Home</a>
          </li>
             
            <li class="nav-item " style="border-radius: 14px; !important;">
              <a class="nav-link" href="https://wdanna.com/posts/blog/" >Blog  </a>
            </li>
          
             
            <li class="nav-item " style="border-radius: 14px; !important;">
              <a class="nav-link" href="https://wdanna.com/posts/books/" >Books  </a>
            </li>
          
             
            <li class="nav-item " style="border-radius: 14px; !important;">
              <a class="nav-link" href="https://wdanna.com/posts/about/" >About  </a>
            </li>
          
          
        </ul>

      </div>

    </div>
  </nav>
  
 
      







<div id="site-header" class="carousel slide carousel-fade" data-ride="carousel" style="height: 18rem;" >  

  
  
  

  
  <div class="carousel-inner" role="listbox">
    
      

        
        <div class="carousel-item active">
          <div class="view" style="background-image: url('https://wdanna.com/img/header-slides/raw_1515691711.jpg'); background-repeat: no-repeat; background-size: cover;">

            
            <div class="mask rgba-black-light d-flex justify-content-center align-items-center" style="background-color: rgba(0,0,0,.5);">

              
              
              

            </div>
            

          </div>
        </div>
        
      
    
      

        
        <div class="carousel-item">
          <div class="view" style="background-image: url('https://wdanna.com/img/header-slides//raw_1515691712.jpg'); background-repeat: no-repeat; background-size: cover;">

            
            <div class="mask rgba-black-light d-flex justify-content-center align-items-center" style="background-color: rgba(0,0,0,.5);">

            

            </div>
            

          </div>
        </div>
        
      
    
      

        
        <div class="carousel-item">
          <div class="view" style="background-image: url('https://wdanna.com/img/header-slides//raw_1515691719.jpg'); background-repeat: no-repeat; background-size: cover;">

            
            <div class="mask rgba-black-light d-flex justify-content-center align-items-center" style="background-color: rgba(0,0,0,.5);">

            

            </div>
            

          </div>
        </div>
        
      
    

  
  </div>
  

  
  <div class="carousel-content text-center white-text wow fadeIn">
    <div class="row mx-0 headfont mt-3 pt-4">
      
      <div class="col-12 col-sm-5 align-middle">
        <a href="https://wdanna.com/">
            <img class="pull-right avatar avatar-md" src="https://image.wdanna.com/avatar/favicon.ico" alt="">
        </a>
      </div>
      
      <div class="col-12 col-sm-7 text-left pl-2">
        <a href="https://wdanna.com/">
          <h1 class="mb-2 h1" style="font-weight: 300;" >
            <strong>半生不熟 | Amber</strong>
          </h1>
        </a>
        

             
        <div class="mt-2" style="font-size: 1rem; color: white;">
            
              <a href="https://github.com/banshengbushu" target="_blank" rel="noopener"><i class="fab fa-github pr-1" aria-hidden="true"></i></a>    
            
            
              <a href="https://www.zhihu.com/people/banshengbushu/activities" target="_blank" rel="noopener"><i class="fab fa-zhihu pr-1" aria-hidden="true"></i></a>
            

            
            <a href="https://500px.com/_amber" target="_blank" rel="noopener"><i class="fab fa-500px pr-1" aria-hidden="true"></i></a>
            

            
              <a href="https://www.facebook.com/Amber.pepperr" target="_blank" rel="noopener"><i class="fab fa-facebook pr-1" aria-hidden="true"></i></a>
            

            

            
                <a href="https://twitter.com/Dannaw_" target="_blank" rel="noopener"><i class="fab fa-twitter pr-1" aria-hidden="true"></i></a>
            

            
                <a href="https://www.instagram.com/amber.pepper_/" target="_blank" rel="noopener"><i class="fab fa-instagram pr-1" aria-hidden="true"></i></a>
            
    

            
                <a href="mailto:wangdanna1995@outlook.com"><i class="far fa-envelope-open pr-1" aria-hidden="true"></i></a>
            
    
            

            
        </div>
      </div>
    </div>
  </div>
  

  
  
  

</div>
  
    

    
  
  <main class="post-main-wrapper">
    
    
    <div class="row">

      

      
      <div class="container pr-5">
      

        
        <div class="z-depth-1  post-wrapper white-bg single-post">

          <div class="post-header text-center" >
  <ul class="post-meta li-x">
    
      
        <li><a href="https://wdanna.com/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91"><i class="fas fa-folder-open pr-1" aria-hidden="true"></i> 前端开发 </a></li>
      
    
    
      
        <li><a href="https://wdanna.com/series/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91"><i class="fas fa-bookmark pr-1" aria-hidden="true"></i>前端开发</a></li>
      
    
  </ul>

  <div class="px-2 post-heading">模态框和禁止页面滚动</div>

  <ul class="post-meta li-x mt-1">
    
      <li>Jan 1, 0001</li>
    

    
      <li class="middot"></li>
      <li>3 minutes read</li>
    
  </ul>
  

</div>


          <div class="post-content markdown">
            

<h2 id="问题">问题</h2>

<p>今天帮朋友看了一个问题，是要实现点击按钮出现一个弹框以及背景遮罩的功能。</p>

<p>因为项目在用Bootstrap，所以第一想法当然是直接用Bootstrap的模态框，但是奇葩的是一直出现闪退的情况，但之前从来没有遇到这种情况，就去搜了下。</p>

<p>看到大部分人都说一般是因为JS文件发生了冲突，想了想可能项目引入的库有重写模态框的东西，但是试了半天也没有找到是哪个文件，于是决定换一种方式了，因为项目原因，要尽量少用库和插件实现，所以就去搜了搜，发现最简单的方式就是借助<code>overlay</code>自己写样式实现，因为觉得是一个挺common的东西，就简单总结一下。</p>

<h2 id="需求">需求</h2>

<ul>
<li>点击一个按钮弹出提示框</li>
<li>灰色的遮罩层挡住页面内容</li>
<li>被遮罩的内容禁止点击以及页面滚动功能</li>

<li><p>再次点击按钮提示框消失，启用页面滚动功能</p>

<h2 id="实现">实现</h2></li>
</ul>

<blockquote>
<p>一般做法</p>
</blockquote>

<p>屏幕视窗高度是100vh，当body里面承载的内容大于100vh时，屏幕就会出现上下滚动条，要制作这个效果只需要设置html的高度为100%占满屏幕，并且将html的overflow设置为hidden，即可保证页面不可滚动。</p>

<p>但是由于滚动条没有了，宽度变宽，页面内容会整体偏移一点，或多或少会影响用户体验。</p>

<blockquote>
<p>更合理的做法
* 将内容块独立出来，再声明一个 .overlay 结构用来做背景遮罩，优势是，遮罩层可以被复用，任何需要弹窗的场景，都可以直接用 overlay 这个遮罩层。</p>
</blockquote>

<ul>
<li>不允许页面滚动，定义Js<code>stopScrolling()</code>方法，用<code>on</code>和<code>off</code>控制启动和禁用，使用<code>e.preventDefault()</code>方法将通知 Web 浏览器不要执行与事件关联的默认动作（如果存在这样的动作）.
例如，如果 type 属性是 &ldquo;submit&rdquo;，在事件传播的任意阶段可以调用任意的事件句柄，通过调用该方法，可以阻止提交表单。</li>
</ul>

<pre><code>&lt;a id=&quot;link&quot; href=&quot;http://wuliv.com&quot;&gt;网站&lt;/a&gt;
$('#link').click(function(event){
    event.preventDefault(); // 阻止了a链接href的访问或跳转
})
</code></pre>

<p>使用<code>e.stopPropagation()</code>阻止事件冒泡，使用<code>return false</code>阻止元素在浏览器中的默认行为，但请慎用这个功能，虽然自己使用的不多，但看一遍大神如是说，
&gt;当你每次调用”return false“的时候，它实际上做了3件事情：
　　• event.preventDefault();
　　• event.stopPropagation();
　　• 停止回调函数执行并立即返回。</p>

<p>具体想研究的小伙伴，可以点击这里 <a href="http://www.cnblogs.com/dannyxie/p/5642727.html">preventDefault()、stopPropagation()、return false 之间的区别</a></p>

<ul>
<li>HTML代码
```
<body>
<a class="display_modal" href="#">显示弹窗</a></li>
</ul>

<p><p>正文内容</p>
  <p>正文内容</p>
  <p>正文内容</p>
  <p>正文内容</p>
  <p>正文内容</p>
  <p>正文内容</p>
  <p>正文内容</p>
  <p>正文内容</p>
  <p>正文内容</p>
  <p>正文内容</p>
  <p>正文内容</p>
  <p>正文内容</p>
  <p>正文内容</p>
  <p>正文内容</p></p>

<div class="modal_content">
  这里是弹窗内容
</div>

<p><div class="overlay"></div>
</body></p>

<pre><code>* CSS代码
</code></pre>

<p>.overlay{
  display: none;
  position: fixed;
  top: 80px;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0,0,0,.8);
}</p>

<p>.modal_content{
  display: none;
  margin: 10px auto;
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  width: 200px;
  height: 1000px;
  background: #fff;
  z-index: 10;
}</p>

<pre><code>
* Js代码
</code></pre>

<p><script type="text/javascript">
  $(document).ready(function () {
    $(&lsquo;.display_modal&rsquo;).click(function () {
      $(&lsquo;.overlay,.modal_content&rsquo;).fadeOut(&ldquo;fast&rdquo;);
      $(&lsquo;.overlay,.modal_content&rsquo;).show();</p>

<pre><code>  $('body').on('scroll mousewheel touchmove', stopScrolling);
});

$('.overlay,.modal_content').click(function () {
  $('.overlay,.modal_content').fadeIn(&quot;fast&quot;);
  $('.overlay,.modal_content').hide();

  $('body').off('scroll mousewheel touchmove', stopScrolling);
});
</code></pre>

<p>});</p>

<p>function stopScrolling (e) {
    e.preventDefault();
    e.stopPropagation();
    return false;
  }</p>

<p></script>
```</p>

<ul>
<li>关于Overlay，由于中文资料不多，找了下英文解释
&gt;overlay is described as: Content is clipped and scroll bars are added when necessary. Importantly its also said only to work in Safari or Chrome (ie
WebKit).
This item on WebKit bugzilla suggest it is not long for this world in
any case: WebKit currently has a proprietary CSS overflow value called &ldquo;overlay&rdquo;
which is undocumented and as far as I can &gt; tell from reading the code
works exactly like &ldquo;auto&rdquo;. We should either remove it or rename it to &ldquo;-webkit-overlay&rdquo;.</li>
</ul>

<p>更详细的解释，请点击 <a href="https://tympanus.net/codrops/2013/11/07/css-overlay-techniques/">设置overlay的模态框</a>和 <a href="https://www.w3schools.com/howto/howto_css_overlay.asp">overlay亲手试一试</a></p>

<p>这样就可以实现最开始所有需求了。</p>

          </div>

          
          <div class="row">
            <div class="col-md-8">
            
              <div class="mb-5">
                
<div class="li-x div-x post-meta">
  <li class="pr-0"><a href="https://wdanna.com/tags/"><i class="fas fa-tags"></i></a></li>
  <div class="tags-sm">
    
      <li><a href="https://wdanna.com/tags/%E5%BC%80%E5%8F%91" role="button">开发 </a></li>
      
    
  </div>
</div>
              </div>
            
            </div>
            
          </div>
          

          
          <div class="row pt-3">
            <div class="col-md-6">
              
            </div>
            
            <div class="col-md-6 text-right" >
              
            </div>
          </div>

          

        </div>
        

      </div>
      

      

    </div>
    


  </main>
  


    
    

<footer class="page-footer text-center font-small mt-4 wow fadeIn">


  
  <div class="pb-2 mt-5 pt-5">
    
      <a href="https://github.com/banshengbushu " target="_blank" rel="noopener"><i class="fab fa-github mr-3" aria-hidden="true"></i></a>    
    
      
      <a href="https://www.zhihu.com/people/banshengbushu/activities" target="_blank" rel="noopener"><i class="fab fa-zhihu pr-1" aria-hidden="true"></i></a>
      

      
      <a href="https://500px.com/_amber" target="_blank" rel="noopener"><i class="fab fa-500px mr-3" aria-hidden="true"></i></a>
      

    
      <a href="https://www.facebook.com/Amber.pepperr" target="_blank" rel="noopener"><i class="fab fa-facebook-f mr-3" aria-hidden="true"></i></a>
    

    

    
        <a href="https://twitter.com/Dannaw_" target="_blank" rel="noopener"><i class="fab fa-twitter mr-3" aria-hidden="true"></i></a>
    

    
        <a href="https://www.instagram.com/amber.pepper_/" target="_blank" rel="noopener"><i class="fab fa-instagram mr-3" aria-hidden="true"></i></a>
    

    
        <a href="mailto:wangdanna1995@outlook.com"><i class="far fa-envelope-open mr-3" aria-hidden="true"></i></a>
    

    

    

  </div>
  

  
  <div class="copyright py-4">
    
    <span>  2016 - 2019 &copy; | By  <a href='https://github.com/banshengbushu/blog' target="_blank">Banshengbushu</a>  </span>
  </div>
  

</footer>


    






<script type="text/javascript" src="https://wdanna.com/js/vendors/jquery/jquery-3.3.1.min.js"></script>
<script type="text/javascript" src="https://wdanna.com/js/vendors/jquery/jquery.smooth-scroll.min.js"></script>



<script type="text/javascript" src="https://wdanna.com/js/vendors/popper.min.js"></script>
<script type="text/javascript" src="https://wdanna.com/js/vendors/holder.min.js"></script>
<script type="text/javascript" src="https://wdanna.com/js/vendors-extensions/bootstrap4/bootstrap.js" ></script>

<script type="text/javascript" src="https://wdanna.com/js/vendors/mdb/mdb.min.js"></script>

<script type="text/javascript" src="https://wdanna.com/js/main.js"></script>



  
  <script src="https://wdanna.com/js/vendors/highlight.pack.js"> </script>
  <script>hljs.initHighlightingOnLoad();</script>




 
  <script src="https://wdanna.com/js/vendors/katex/katex.min.js"> </script>
  <script src="https://wdanna.com/js/vendors/katex/contrib/auto-render.min.js"></script>

  <script>
      document.addEventListener("DOMContentLoaded", function () {
          renderMathInElement(document.body);
      });
  </script>








<script type="text/javascript">
  
  new WOW().init();
</script>




  </body>
</html>